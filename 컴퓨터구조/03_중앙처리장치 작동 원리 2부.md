# 중앙처리장치 작동 원리 2부

### 명령어 세트란?

<img src="03_중앙처리장치 작동 원리 2부.assets/image-20220318192314923.png">

CPU가 실행할 명령어의 집합

> 연산 코드(Operation Code) + 피연산자(Operand)로 이루어짐
>
> 연산 코드 : 실행할 연산
>
> 피연산자 : 필요한 데이터 or 저장 위치

연산 코드는 연산, 제어, 데이터 전달, 입출력 기능을 가짐

피연산자는 주소, 숫자/문자, 논리 데이터 등을 저장

CPU는 프로그램 실행하기 위해 주기억장치에서 명령어를 순차적으로 인출하여 해독하고 실행하는 과정을 반복함

CPU가 주기억장치에서 한번에 하나의 명령어를 인출하여 실행하는데 필요한 일련의 활동을 '명령어 사이클'이라고 말함

명령어 사이클은 인출/실행/간접/인터럽트 사이클로 나누어짐

<img src="03_중앙처리장치 작동 원리 2부.assets/image-20220318192601225.png">

| **명령사이클**                  | **설명**                                                     |
| ------------------------------- | ------------------------------------------------------------ |
| 인출사이클(Fetch Cycle)         | - 주기억장치로부터 수행할 명령어를 CPU로 가져오는 단계<br />- 하나의 명령을 수행한 후 다음 명령을 메인 메모리에서 CPU로 꺼내 오는 단계<br />- 명령어의 Operand가 간접 주소일 경우: Indirect Cycle로 진행<br />- 명령어의 Operand가 직접 주소일 경우: Execute Cycle로 진행 |
| 간접사이클(Indirect Cycle)      | - 명령어의 Operand가 간접주소 지정이 된 경우 유효 주소를 계산하기 위해 주기억장치에 접근하는 단계<br />- 명령의 실행을 위해 Execute Cycle로 진행됨<br />- 명령어에 포함되어 있는 주소를 이용하여, 그 명령어 실행에 필요한 데이터의 주소를 인출하는 사이클 |
| 실행사이클(Execute Cycle)       | - 명령의 해독결과 이에 해당하는 타이밍 및 제어신호를 순차적으로 발생시켜 실제로 명령어를 실행하는 단계<br />- 명령어 코드를 해독하고, 그 결과에 따라 필요한 연산들을 수행<br />- 실행 사이클에서 수행되는 마이크로 연산들은 명령어에 따라 다름 |
| 인터럽트사이클(Interrupt Cycle) | - 인터럽트 발생시 인터럽트 처리를 위한 단계- 인터럽트에 대한 처리가 완료되면 Fetch Cycle 진행 |

주기억장치의 지정된 주소에서 하나의 명령어를 가져오고, 실행 사이클에서는 명령어를 실행함. 하나의 명령어 실행이 완료되면 그 다음 명령어에 대한 인출 사이클 시작

#### 인출 사이클과 실행 사이클에 의한 명령어 처리 과정

> 인출 사이클에서 가장 중요한 부분은 PC(프로그램 카운터) 값 증가

- PC에 저장된 주소를 MAR로 전달
- 저장된 내용을 토대로 주기억장치의 해당 주소에서 명령어 인출
- 인출한 명령어를 MBR에 저장
- 다음 명령어를 인출하기 위해 PC 값 증가시킴
- 메모리 버퍼 레지스터(MBR)에 저장된 내용을 명령어 레지스터(IR)에 전달

```
T0 : MAR ← PC
T1 : MBR ← M[MAR], PC ← PC+1
T2 : IR ← MBR
```

여기까지는 인출하기까지의 과정

#### 인출한 이후, 명령어를 실행하는 과정

> ADD addr 명령어 연산

```
T0 : MAR ← IR(Addr)
T1 : MBR ← M[MAR]
T2 : AC ← AC + MBR
```

이미 인출이 진행되고 명령어만 실행하면 되기 때문에 PC를 증가할 필요x

IR에 MBR의 값이 이미 저장된 상태를 의미함

따라서 AC에 MBR을 더해주기만 하면 됨