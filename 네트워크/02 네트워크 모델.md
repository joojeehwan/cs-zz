# 02 네트워크 모델



## 네트워크 모델

1. TCP/IP 모델
2. OSI 7계층 모델



### TCP/IP 모델

<img src="02 네트워크 모델.assets/image-20220307005619521.png" alt="TCP/IP 모델">

- 1960년대 말 미국방성의 연구에서 시작되어 1980년대 초 프로토콜 모델로 공개
- 현재 인터넷에서 컴퓨터들이 서로 정보를 주고받는데 쓰이는 **통신 규약(프로토콜)의 모음**

- 4개의 계층으로 이루어져있다.



### OSI 7계층

<img src="02 네트워크 모델.assets/image-20220307013925409.png" alt="OSI 7계층">

- 1984년 네트워크 통신을 체계적으로 다루는 ISO(국제표준화기구)에서 표준으로 지정한 **모델**
- 데이터를 주고받을 때 데이터 자체의 흐름을 각 구간별로 나눠 놓은 것
- 실질적으로 데이터 전송할 때는 TCP/IP에 더 가깝다.
- 중요한 것(프로토콜 구조까지 알아야함) 
  - `이더넷`
  - ``IP(Internet Protocl address)`, `ICMP(Internet Control Message Protocol)`, `ARP(Address Resolution Protocol)`
  - `TCP(Transmission Control Protocol)`, `UDP(User Datagram Protocol)`
  - `HTTP(HyperText Transfer Protocol)`

- 이 외에는 저런게 있구나 정도만 알면 된다.



## 두 모델 비교

### 공통점

- 네트워크를 **계층**으로 나눠 분류한다.
- 각각의 계층별로 **역할**을 지정해놓고 사용한다.

### 차이점

- 계층의 수 차이(4 vs 7)
- OSI는 **논리적**으로 통신 전반에 걸쳐 **역할을 나눔** , TCP/IP는 **실무적**으로 네트워크를 통해서 데이터를 전달할 때, **프로토콜**을 분류
- 실제로 네트워크 프로토콜을 캡쳐해서 봐보면 TCP/IP에 가깝다.
  - TCP/IP의 네트워크 인터페이스를 굳이 OSI에선 물리, 데이터링크 계층으로 나눈 셈
  - HTTP 프로토콜안에도 응용, 표현, 세션이 다 들어가있다. 그래서 HTTP를 7계층으로 표현하긴 하지만 5, 6, 7로 나누기 어렵다.
- OSI는 통신 전반에 대한 표준, TCP/IP는 데이터 전송기술 특화





## 패킷

- 네트워크를 통해 전달되는 데이터

- 네트워크에서 전달하는 데이터의 형식화된 **블록**이다.

- 패킷은 제어 정보와 사용자 데이터로 이루어지며 사용자 데이터는 **페이로드**라고 한다.

- 패킷 프로토콜에는 **순서**가 있다.(포장 안에 포장 안에 포장 안에 상품처럼)

- 여러 프로토콜들로 캡슐화됨
   | 헤더 | 페이로드(=실질적 데이터) | 풋터 |
   | ---- | ------------------------ | ---- |
   
   - 일반적으로 풋터는 잘 사용하지 않음, 대부분 헤더만 사용 
   
   - 유일하게 풋터를 사용하는 프로토콜 = 이더넷
   
     

### 캡슐화 Encapsulatoin

여러 프로토콜을 이용해서 최종적으로 **보낼 때** 패킷을 만드는 과정

#### 

<img src="02 네트워크 모델.assets/image-20220307015208073.png" alt="캡슐화">

1. `[데이터]`
2. `TCP(헤더)` + `[데이터]`
3. `IPv4(헤더)` + `[TCP + [데이터]]`
4. `Ethernet(헤더)` + `[IPv4 + [TCP + [데이터]]]`

- 프로토콜을 하나씩 붙여나가는 과정을 **encapsulation**이라고 한다.
- **상위** 계층에서부터 **하위** 계층으로 <u>내려가면서</u> 프로토콜을 붙인다.
- 프로토콜을 붙일 때, 하위 프로토콜 앞에 상위 프로토콜이 올 수 없다.
  - TCP는 4계층, IPv4는 3계층, Ethernet은 2계층이다.
  - 위의 형태가 일반적이지만, `2계층 + 3계층 + 3계층 + 데이터` 는 가능하다.



### 디캡슐화 Decapsulation

패킷을 **받았을 때** 프로토콜들을 하나씩 확인하면서 데이터를 확인하는 과정

<img src="02 네트워크 모델.assets/image-20220307020135567.png" alt="디캡슐화">

- **하위** 프로토콜부터 하나씩 열어보면서 양식대로 <u>누가</u> 나한테 <u>뭘</u> 보냈는지 확인한다.
- 확인할 때 3계층 확인했다가 2계층 확인하는 이런 방식은 없다. **순차적**으로 진행.



### PDU (Protocol Data Unit)

<img src="02 네트워크 모델.assets/capsulation.png" alt="패킷">

계층별 패킷의 이름 

- TCP + 데이터 = 세그먼트(4계층)
- IPv4 + TCP + 데이터 = 패킷(3계층)
  - 통상적으로 부르는 패킷과 이름은 같지만 뜻은 <u>다르다</u>.
- Ethernet + IPv4 + TCP + 데이터 = 프레임(2계층)
  - 이걸 통상적으로 패킷이라고 부르고, 프레임은 이 자체를 자세하게 의미하는 것
  - 패킷이라는 용어를 자주 사용하는데 자세히 말할 땐 프레임으로 사용



## 실습) 실제로 패킷 구조 보기

- `ping 8.8.8.8` : 구글 DNS(Domain Name System)에 신호보내고 wireshark에서 확인하기

<img src="02 네트워크 모델.assets/ping.png" alt="패킷">

### ARP

<img src="02 네트워크 모델.assets/ARP.png" alt="패킷">



- 구조는 ARP를 이더넷이 감싸고 있다. 이더넷이 유일하게 footer가 있는 프로토콜이라 footer가 보인다.
- ARP자체가 payload다.
- ARP는 3계층, 이더넷은 2계층이므로 ARP앞에 헤더로 이더넷이 붙었다.





### ICMP

<img src="02 네트워크 모델.assets/ICMP.png" alt="패킷">

- ICMP를 검색해보고 아무 기록이나 눌러본다.
- 구조는 ICMP에 IPv4라는 헤더가 붙었고, 그 앞에 이더넷 헤더가 붙었다.
- IPv4와 ICMP도 순서가 정해져있다.
